package gen

var (
	codeGenHint = "// Code generated by 'gorm.io/cli/gorm'. DO NOT EDIT."
	pkgTmpl     = codeGenHint + `

package {{.ToPackage}}

import (
    "gorm.io/gorm"
    "gorm.io/gorm/clause"
    "gorm.io/cli/gorm/field"
    {{- if .UsedTypedAPI }}
    "gorm.io/cli/gorm/typed"
    {{- end }}
    {{range .Imports -}}
    {{.ImportPath}}
    {{end -}}
)

{{range .Interfaces}}
{{$IfaceName := .IfaceName}}
func {{.Name}}[T any](db *gorm.DB, opts ...clause.Expression) {{$IfaceName}}Interface[T] {
    return {{$IfaceName}}Impl[T]{
        Interface: {{if $.UsedTypedAPI}}typed{{else}}gorm{{end}}.G[T](db, opts...),
    }
}

type {{$IfaceName}}Interface[T any] interface {
    {{if $.UsedTypedAPI}}typed{{else}}gorm{{end}}.Interface[T]
    {{range .Methods -}}
    {{.Name}}({{.ParamsString}}) ({{.ResultString}})
    {{end}}
}

type {{$IfaceName}}Impl[T any] struct {
    {{if $.UsedTypedAPI}}typed{{else}}gorm{{end}}.Interface[T]
}

{{range .Methods}}
func (e {{$IfaceName}}Impl[T]) {{.Name}}({{.ParamsString}}) ({{.ResultString}}) {
	{{.Body}}
}
{{end}}
{{end}}

{{range .Structs}}
var {{.Name}} = struct {
	{{range .Fields -}}
	{{.Name}} {{.Type}}
	{{end}}
}{
	{{range .Fields -}}
	{{.Name}}: {{.Value}},
	{{end -}}
}
{{end}}
`
)
